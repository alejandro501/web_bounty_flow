<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bounty Flow UI</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body data-backend-url="http://localhost:8181">
    <main class="layout">
      <h1 class="page-title">Bounty Flow Control</h1>

      <section class="panel panel-upload">
        <h2>Upload a scope file</h2>
        <form id="upload-form">
          <label>
            List type
            <select name="list_type" required>
              <option value="">— Select —</option>
              <option value="organizations">Organizations</option>
              <option value="wildcards">Wildcards</option>
              <option value="domains">Domains</option>
              <option value="apidomains">API Domains</option>
              <option value="ips">IPs</option>
              <option value="out_of_scope">Out of scope</option>
            </select>
          </label>
          <label>
            Text file (.txt)
            <input type="file" name="file" accept=".txt" required />
          </label>
          <button type="submit">Upload</button>
        </form>
        <p id="upload-status" class="muted">Pending upload</p>
      </section>

      <section class="panel panel-append">
        <h2>Append a single entry</h2>
        <form id="url-form">
          <label>
            List type
            <select name="list_type" required>
              <option value="">— Select —</option>
              <option value="organizations">Organizations</option>
              <option value="wildcards">Wildcards</option>
              <option value="domains">Domains</option>
              <option value="apidomains">API Domains</option>
              <option value="ips">IPs</option>
              <option value="out_of_scope">Out of scope</option>
            </select>
          </label>
          <label>
            URL / entry
            <input type="text" name="url" placeholder="https://example.com or *.example.com" required />
          </label>
          <button type="submit">Append</button>
        </form>
        <p id="url-status" class="muted">No submission yet</p>
      </section>

      <section class="panel panel-flow">
        <h2>Flow control</h2>
        <button id="run-flow">Run flow</button>
        <p id="flow-status" class="muted">idle</p>
        <p>Current status will refresh automatically</p>
        <div class="flow-steps">
          <p class="muted">Flow order</p>
          <ul>
            <li>Load flow.conf and parse --organization / --org-list inputs.</li>
            <li>Passive recon: generate_dork_links for organizations (API-focused queries).</li>
            <li>Passive recon: subfinder on wildcards -> append to domains.</li>
            <li>Passive recon: filter out-of-scope entries from domains.</li>
            <li>Passive recon: httprobe API domains (grep api -> apidomains).</li>
            <li>Passive recon: generate_dork_links for wildcards, domains, apidomains; move outputs into dorking/ buckets.</li>
            <li>Passive recon: robots fetch + sitemap extraction for wildcards/domains/apidomains.</li>
            <li>Passive recon: sort_http on domains.</li>
            <li>Documentation fuzzing: ffuf against orgs/wildcards/apidomains.</li>
            <li>Directory fuzzing: ffuf against apidomains/wildcards.</li>
            <li>Nmap scans: domains, apidomains, then IPs.</li>
            <li>Process .gnmap summaries and run searchsploit mapping.</li>
            <li>Security checks: toxicache, hop-by-hop, request smuggling, h2csmuggler, ssi/esi, cloudflare checks.</li>
          </ul>
        </div>
      </section>

      <section class="panel panel-scope">
        <h2>Scope entries</h2>
        <label>
          Current list
          <select id="list-view-select">
            <option value="wildcards">Wildcards</option>
            <option value="domains">Domains</option>
            <option value="apidomains">API Domains</option>
            <option value="organizations">Organizations</option>
            <option value="ips">IPs</option>
            <option value="out_of_scope">Out of scope</option>
          </select>
        </label>
        <pre id="list-view-output" class="log-view">Select a list to show entries.</pre>
      </section>

      <section class="panel panel-logs">
        <h2>Flow logs</h2>
        <pre id="flow-log-output" class="log-view log-view--tall">Logs appear here when you start the flow.</pre>
      </section>
    </main>
    <script src="app.js"></script>
  </body>
</html>
